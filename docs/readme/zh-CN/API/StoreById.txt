<h2>StoreById</h2>
<p>使用 localStorage 的对象形式存储</p>
<pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#89DDFF"> {</span><span style="color:#89DDFF;font-style:italic"> type</span><span style="color:#BABED8"> SelfKeyPath</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> StoreById</span><span style="color:#89DDFF"> }</span><span style="color:#89DDFF;font-style:italic"> from</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">utils-where</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic">// localStorage.app 类似于 {theme: 1, head: {show: true, title: 0}, foot: {show: false, tip: 'xxx'}, {one: {two: {three: {four: null}}}}}</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#BABED8"> ini </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> new</span><span style="color:#82AAFF"> StoreById</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">app</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">  theme</span><span style="color:#89DDFF">:</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#F07178">  head</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">    show</span><span style="color:#89DDFF">:</span><span style="color:#FF9CAC"> false</span></span>
<span class="line"><span style="color:#89DDFF">  }</span></span>
<span class="line"><span style="color:#89DDFF">}</span><span style="color:#BABED8">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#82AAFF">setVal</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">head.show</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#FF9CAC"> true</span><span style="color:#BABED8">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#82AAFF">save</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">{</span><span style="color:#F07178"> theme</span><span style="color:#89DDFF">:</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF"> }</span><span style="color:#BABED8">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#82AAFF">setVal</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">foot.show</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#FF9CAC"> false</span><span style="color:#BABED8">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#82AAFF">save</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">{</span><span style="color:#F07178"> head</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> {</span><span style="color:#F07178"> title</span><span style="color:#89DDFF">:</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF"> }</span><span style="color:#89DDFF"> }</span><span style="color:#BABED8">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#82AAFF">save</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#F07178">    foot</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">      tip</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">xxx</span><span style="color:#89DDFF">'</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">  }</span><span style="color:#BABED8">)</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#82AAFF">setVal</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">one.two.three.four</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> null</span><span style="color:#BABED8">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BABED8">ini</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">getVal</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">foot.show</span><span style="color:#89DDFF">'</span><span style="color:#BABED8">) </span><span style="color:#89DDFF">===</span><span style="color:#BABED8"> ini</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">getVal</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">false</span><span style="color:#89DDFF">></span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">foot.show</span><span style="color:#89DDFF">'</span><span style="color:#BABED8">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF">new</span><span style="color:#82AAFF"> StoreById</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">app2</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">  custom</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">    lang</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> ''</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#F07178">    theme</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">light</span><span style="color:#89DDFF">'</span></span>
<span class="line"><span style="color:#89DDFF">  }</span></span>
<span class="line"><span style="color:#89DDFF">}</span><span style="color:#BABED8">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic">  // 移除本地存储中的某个键</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#82AAFF">setVal</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">custom.theme</span><span style="color:#89DDFF">'</span><span style="color:#676E95;font-style:italic"> /* undefined */</span><span style="color:#BABED8">) </span><span style="color:#676E95;font-style:italic">// 传递 undefined 效果相同</span></span>
<span class="line"><span style="color:#89DDFF">  .</span><span style="color:#82AAFF">save</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#F07178">    custom</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">      lang</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> undefined</span><span style="color:#676E95;font-style:italic"> // 此处需要 undefined</span></span>
<span class="line"><span style="color:#89DDFF">    }</span></span>
<span class="line"><span style="color:#89DDFF">  }</span><span style="color:#BABED8">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">type</span><span style="color:#FFCB6B"> Config</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">  user</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">    id</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> string</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#F07178">    pwd</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> string</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">  };</span></span>
<span class="line"><span style="color:#F07178">  app</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#F07178">    theme</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> string</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">  };</span></span>
<span class="line"><span style="color:#89DDFF">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic">// 需要访问 `data` 时获取其具体类型</span></span>
<span class="line"><span style="color:#89DDFF">new</span><span style="color:#82AAFF"> StoreById</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">Config</span><span style="color:#89DDFF">></span><span style="color:#BABED8">()</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">data</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">user</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic">// 如果需要，检查键路径</span></span>
<span class="line"><span style="color:#89DDFF">new</span><span style="color:#82AAFF"> StoreById</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">Config</span><span style="color:#89DDFF">,</span><span style="color:#FFCB6B"> SelfKeyPath</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#FFCB6B">Config</span><span style="color:#89DDFF">>></span><span style="color:#BABED8">()</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">setVal</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">app.theme</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> ''</span><span style="color:#BABED8">)</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">getVal</span><span style="color:#BABED8">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">user.id</span><span style="color:#89DDFF">'</span><span style="color:#BABED8">)</span><span style="color:#89DDFF">;</span></span></code></pre>
<ul>
<li>type</li>
</ul>
<pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8" tabindex="0"><code><span class="line"><span style="color:#BABED8">StoreById</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#BABED8">T extends Obj </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> Obj</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> K extends string </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> string</span><span style="color:#89DDFF">></span><span style="color:#BABED8">(id</span><span style="color:#89DDFF">?:</span><span style="color:#BABED8"> string </span><span style="color:#89DDFF">|</span><span style="color:#89DDFF"> null,</span><span style="color:#BABED8"> data</span><span style="color:#89DDFF">?:</span><span style="color:#BABED8"> T): StoreById</span><span style="color:#89DDFF">&#x3C;</span><span style="color:#BABED8">T</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> K</span><span style="color:#89DDFF">></span></span></code></pre>
