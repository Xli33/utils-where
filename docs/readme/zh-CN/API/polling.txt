<h2>polling</h2>
<p>轮询传入的函数，仅在当次函数调用后才继续下次轮询</p>
<pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#89DDFF"> {</span><span style="color:#BABED8"> polling</span><span style="color:#89DDFF"> }</span><span style="color:#89DDFF;font-style:italic"> from</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">utils-where</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic">// 每2秒执行一次cb</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#BABED8"> cb </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> (</span><span style="color:#BABED8;font-style:italic">arg1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> arg2</span><span style="color:#89DDFF">)</span><span style="color:#C792EA"> =></span><span style="color:#89DDFF"> {</span></span>
<span class="line"><span style="color:#BABED8">  console</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">log</span><span style="color:#F07178">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">polling</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> arg1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> arg2</span><span style="color:#F07178">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#89DDFF">};</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#BABED8"> poller </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> polling</span><span style="color:#BABED8">(cb</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2000</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">arg1</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">arg2</span><span style="color:#89DDFF">'</span><span style="color:#BABED8">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BABED8">poller</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">run</span><span style="color:#BABED8">()</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic">// 大约5秒后停止轮询</span></span>
<span class="line"><span style="color:#82AAFF">setTimeout</span><span style="color:#BABED8">(poller</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">stop</span><span style="color:#BABED8">()</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 5000</span><span style="color:#BABED8">)</span><span style="color:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic">// 直接在`run`中传入对应参数，优先级高于`polling(...args)`所传参数</span></span>
<span class="line"><span style="color:#C792EA">const</span><span style="color:#BABED8"> poller </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> polling</span><span style="color:#BABED8">()</span><span style="color:#89DDFF">;</span></span>
<span class="line"><span style="color:#BABED8">poller</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">run</span><span style="color:#BABED8">(cb</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1000</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">arg1</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">arg2</span><span style="color:#89DDFF">'</span><span style="color:#BABED8">)</span><span style="color:#89DDFF">;</span></span></code></pre>
<ul>
<li>type</li>
</ul>
<pre class="shiki material-theme-palenight" style="background-color:#292D3E;color:#babed8" tabindex="0"><code><span class="line"><span style="color:#82AAFF">polling</span><span style="color:#BABED8">(callback</span><span style="color:#89DDFF">?:</span><span style="color:#BABED8"> Func</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> interval</span><span style="color:#89DDFF">?:</span><span style="color:#BABED8"> number</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> ...</span><span style="color:#BABED8">args: any[]): </span><span style="color:#89DDFF">{</span></span>
<span class="line"><span style="color:#F07178">    tid</span><span style="color:#89DDFF">:</span><span style="color:#BABED8"> TimeoutId </span><span style="color:#89DDFF">|</span><span style="color:#89DDFF"> null</span><span style="color:#BABED8">;</span></span>
<span class="line"><span style="color:#82AAFF">    run</span><span style="color:#BABED8">(handle</span><span style="color:#89DDFF">?:</span><span style="color:#BABED8"> Func</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> handleInterval</span><span style="color:#89DDFF">?:</span><span style="color:#BABED8"> number</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> ...</span><span style="color:#BABED8">handleArgs: any[]): </span><span style="color:#89DDFF">void</span><span style="color:#BABED8">;</span></span>
<span class="line"><span style="color:#82AAFF">    stop</span><span style="color:#BABED8">(): </span><span style="color:#89DDFF">void</span><span style="color:#BABED8">;</span></span>
<span class="line"><span style="color:#89DDFF">}</span></span></code></pre>
